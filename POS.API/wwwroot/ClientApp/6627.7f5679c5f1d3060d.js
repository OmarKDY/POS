"use strict";(self.webpackChunkposadminportal=self.webpackChunkposadminportal||[]).push([[6627],{5519:(T,d,s)=>{s.d(d,{r:()=>p});class p{constructor(){this.fields="",this.orderBy="",this.searchQuery="",this.pageSize=30,this.skip=0,this.name="",this.totalCount=0}}},1781:(T,d,s)=>{s.d(d,{v:()=>f});var p=s(1086),h=s(520),C=s(5e3);let f=(()=>{class c{constructor(o){this.http=o}getCustomers(o){const l=(new h.LE).set("fields",o.fields).set("orderBy",o.orderBy).set("pageSize",o.pageSize.toString()).set("skip",o.skip.toString()).set("searchQuery",o.searchQuery).set("customerName",o.customerName).set("mobileNo",o.mobileNo).set("phoneNo",o.phoneNo).set("email",o.email).set("contactPerson",o.contactPerson).set("website",o.website);return this.http.get("customer",{params:l,observe:"response"})}getCustomersForDropDown(o,a){if(a&&o){let P=`?searchQuery=${a.trim()}&searchBy=${o}&pageSize=10`;return this.http.get("customer/search"+P)}return(0,p.of)([])}getWalkInCustomer(){return this.http.get("customer/walkIn")}getCustomer(o){return this.http.get("customer/"+o)}deleteCustomer(o){return this.http.delete("customer/"+o)}updateCustomer(o,a){return this.http.put("customer/"+o,a)}saveCustomer(o){return this.http.post("customer",o)}checkEmailOrPhoneExist(o,a,l){return this.http.get(`customer/${l}/Exist?email=${o}&mobileNo=${a}`)}getCustomerPayments(o){const l=(new h.LE).set("Fields",o.fields).set("OrderBy",o.orderBy).set("PageSize",o.pageSize.toString()).set("Skip",o.skip.toString()).set("SearchQuery",o.searchQuery).set("customerName",o.customerName);return this.http.get("customer/GetCustomerPayment",{params:l,observe:"response"})}getCustomerPaymentsReport(o){const l=(new h.LE).set("Fields",o.fields).set("OrderBy",o.orderBy).set("PageSize",o.pageSize.toString()).set("Skip",o.skip.toString()).set("SearchQuery",o.searchQuery).set("customerName",o.customerName);return this.http.get("customer/GetCustomerPayment/report",{params:l,observe:"response"})}}return c.\u0275fac=function(o){return new(o||c)(C.LFG(h.eN))},c.\u0275prov=C.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},736:(T,d,s)=>{s.r(d),s.d(d,{CustomerPaymentReportModule:()=>lt});var p=s(9808),h=s(2554),C=s(6087),f=s(4847),c=s(3231),R=s(8929),o=s(6787),a=s(13),l=s(5778),P=s(2868),Z=s(1490),D=s(591),_=s(2654),E=s(1086),M=s(7221),U=s(537);class j{constructor(r){this.customerService=r,this._customerPaymentSubject$=new D.X([]),this._responseHeaderSubject$=new D.X(null),this.loadingSubject=new D.X(!1),this.loading$=this.loadingSubject.asObservable(),this._count=0,this.responseHeaderSubject$=this._responseHeaderSubject$.asObservable()}get count(){return this._count}connect(){return this.sub$=new _.w,this._customerPaymentSubject$.asObservable()}disconnect(){this._customerPaymentSubject$.complete(),this.loadingSubject.complete(),this.sub$.unsubscribe()}loadData(r){this.loadingSubject.next(!0),this.sub$=this.customerService.getCustomerPayments(r).pipe((0,M.K)(()=>(0,E.of)([])),(0,U.x)(()=>this.loadingSubject.next(!1))).subscribe(n=>{if(n&&n.headers){const i=JSON.parse(n.headers.get("X-Pagination"));this._responseHeaderSubject$.next(i);const u=[...n.body];this._count=u.length,this._customerPaymentSubject$.next(u)}})}}var S=s(574),b=s(8017),N=s(8708),t=s(5e3),L=s(1781),x=s(6107),A=s(3075),Y=s(226),m=s(2075),O=s(773),B=s(1062);function w(e,r){1&e&&(t.TgZ(0,"th",33),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NAME")," "))}const Q=function(e){return["/customer/",e]};function $(e,r){if(1&e&&(t.TgZ(0,"td",34)(1,"a",35),t._uU(2),t.qZA()()),2&e){const n=r.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,Q,n.id)),t.xp6(1),t.hij(" ",n.customerName," ")}}function z(e,r){1&e&&(t.TgZ(0,"th",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_AMOUNT")," "))}function H(e,r){if(1&e&&(t.TgZ(0,"td",37),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n.totalAmount)," ")}}function F(e,r){1&e&&(t.TgZ(0,"th",38),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_PAID_AMOUNT")," "))}function k(e,r){if(1&e&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n.totalPaidAmount)," ")}}function I(e,r){1&e&&(t.TgZ(0,"th",38),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_PENDING_AMOUNT")," "))}function J(e,r){if(1&e&&(t.TgZ(0,"td",39),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const n=r.$implicit;t.xp6(1),t.hij(" ",n.totalPendingAmount<0?0:t.lcZ(2,1,n.totalPendingAmount)," ")}}function G(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"th",40)(1,"input",41),t.NdJ("ngModelChange",function(u){t.CHM(n);const y=t.oxw();return t.KtG(y.NameFilter=u)}),t.qZA()()}if(2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngModel",n.NameFilter)}}function K(e,r){1&e&&t._UZ(0,"th",42)}function W(e,r){1&e&&t._UZ(0,"th",42)}function V(e,r){1&e&&t._UZ(0,"th",42)}const X=function(){return[10,20,30]};function q(e,r){if(1&e&&(t.TgZ(0,"td",43),t._UZ(1,"mat-paginator",44),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("length",n.customerResource.totalCount)("pageSize",n.customerResource.pageSize)("pageSizeOptions",t.DdM(3,X))}}function tt(e,r){1&e&&t._UZ(0,"tr",45)}function et(e,r){1&e&&t._UZ(0,"tr",46)}function ot(e,r){1&e&&t._UZ(0,"tr",47)}function nt(e,r){1&e&&t._UZ(0,"tr",48)}function st(e,r){1&e&&(t.TgZ(0,"div",49),t._UZ(1,"mat-spinner"),t.qZA())}const rt=function(){return["customerName-search","totalAmount-search","totalPaidAmount-search","totalPendingAmount-search"]},mt=[{path:"",component:(()=>{class e extends Z.H{constructor(n,i,u,y,g){super(g),this.customerService=n,this.translateService=i,this.utcToLocalTime=u,this.customCurrencyPipe=y,this.translationService=g,this.displayedColumns=["customerName","totalAmount","totalPaidAmount","totalPendingAmount"],this.columnsToDisplay=["footer"],this.isLoadingResults=!0,this.filterObservable$=new R.xQ,this.getLangDir(),this.customerResource=new c.H,this.customerResource.pageSize=10,this.customerResource.orderBy="customerName asc"}get NameFilter(){return this._nameFilter}set NameFilter(n){this._nameFilter=n,this.filterObservable$.next(`customerName##${n}`)}ngOnInit(){this.dataSource=new j(this.customerService),this.dataSource.loadData(this.customerResource),this.getResourceParameter(),this.sub$.sink=this.filterObservable$.pipe((0,a.b)(1e3),(0,l.x)()).subscribe(n=>{this.customerResource.skip=0,this.paginator.pageIndex=0;const i=n.split("##");"customerName"===i[0]&&(this.customerResource.customerName=escape(i[1])),this.dataSource.loadData(this.customerResource)})}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,o.T)(this.sort.sortChange,this.paginator.page).pipe((0,P.b)(()=>{this.customerResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.customerResource.pageSize=this.paginator.pageSize,this.customerResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadData(this.customerResource)})).subscribe()}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(n=>{n&&(this.customerResource.pageSize=n.pageSize,this.customerResource.skip=n.skip,this.customerResource.totalCount=n.totalCount)})}onDownloadReport(){this.customerService.getCustomerPaymentsReport(this.customerResource).subscribe(n=>{let i=[...n.body],u=[[this.translateService.getValue("NAME"),this.translateService.getValue("TOTAL_AMOUNT"),this.translateService.getValue("TOTAL_PAID_AMOUNT"),this.translateService.getValue("TOTAL_PENDING_AMOUNT")]],y=[];i.forEach(v=>{y.push({name:v.customerName,totalAmount:this.customCurrencyPipe.transform(v.totalAmount),totalPaidAmount:this.customCurrencyPipe.transform(v.totalPaidAmount),totalPendingAmount:this.customCurrencyPipe.transform(v.totalPendingAmount<0?0:v.totalPendingAmount)})});let g=S.P6.book_new();S.P6.sheet_add_aoa(g,u);let pt=S.P6.sheet_add_json(g,y,{origin:"A2",skipHeader:!0});S.P6.book_append_sheet(g,pt,this.translationService.getValue("CUSTOMER_PAYMENT_REPORT")),S.NC(g,this.translationService.getValue("CUSTOMER_PAYMENT_REPORT")+".xlsx")})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(L.v),t.Y36(x.D),t.Y36(b.M),t.Y36(N.R),t.Y36(x.D))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-customer-payment-report"]],viewQuery:function(n,i){if(1&n&&(t.Gf(C.NW,5),t.Gf(f.YE,5)),2&n){let u;t.iGM(u=t.CRH())&&(i.paginator=u.first),t.iGM(u=t.CRH())&&(i.sort=u.first)}},features:[t._Bn([b.M,N.R]),t.qOj],decls:43,vars:19,consts:[[1,"page-header-main"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto","col"],[1,"content-header"],[1,"row"],[1,"col-md-4","mb-4"],["type","submit",1,"btn","btn-warning","btn-sm","m-right-10",3,"click"],[1,"fas","fa-download"],[1,"table-responsive"],["mat-table","","multiTemplateDataRows","","matSort","","matSortActive","customerName",1,"table","table-bordered","table-hover",3,"dir","dataSource"],["matColumnDef","customerName","sticky",""],["class","table-column-300","mat-header-cell","",4,"matHeaderCellDef"],["class","table-column-300","mat-cell","",4,"matCellDef"],["matColumnDef","totalAmount"],["class","table-column-200","mat-header-cell","",4,"matHeaderCellDef"],["class","table-column-200","mat-cell","",4,"matCellDef"],["matColumnDef","totalPaidAmount"],["class","table-column-150","mat-header-cell","",4,"matHeaderCellDef"],["class","table-column-150","mat-cell","",4,"matCellDef"],["matColumnDef","totalPendingAmount"],["matColumnDef","customerName-search","sticky",""],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","totalAmount-search","sticky",""],["class","pr-5","mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","totalPaidAmount-search","sticky",""],["matColumnDef","totalPendingAmount-search","sticky",""],["matColumnDef","footer"],["mat-footer-cell","","colspan","4",4,"matFooterCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-row","","class","example-second-header-row",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],["class","loading-shade",4,"ngIf"],["mat-header-cell","",1,"table-column-300"],["mat-cell","",1,"table-column-300"],[3,"routerLink"],["mat-header-cell","",1,"table-column-200"],["mat-cell","",1,"table-column-200"],["mat-header-cell","",1,"table-column-150"],["mat-cell","",1,"table-column-150"],["mat-header-cell",""],["type","text",1,"form-control",3,"ngModel","ngModelChange"],["mat-header-cell","",1,"pr-5"],["mat-footer-cell","","colspan","4"],[3,"length","pageSize","pageSizeOptions"],["mat-header-row",""],["mat-row",""],["mat-header-row","",1,"example-second-header-row"],["mat-footer-row",""],[1,"loading-shade"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t._uU(5),t.ALo(6,"translate"),t.qZA()()()()(),t.TgZ(7,"div",4)(8,"div",5)(9,"button",6),t.NdJ("click",function(){return i.onDownloadReport()}),t._UZ(10,"i",7),t._uU(11),t.ALo(12,"translate"),t.qZA()()(),t.TgZ(13,"div",8)(14,"table",9),t.ynx(15,10),t.YNc(16,w,3,3,"th",11),t.YNc(17,$,3,4,"td",12),t.BQk(),t.ynx(18,13),t.YNc(19,z,3,3,"th",14),t.YNc(20,H,3,3,"td",15),t.BQk(),t.ynx(21,16),t.YNc(22,F,3,3,"th",17),t.YNc(23,k,3,3,"td",18),t.BQk(),t.ynx(24,19),t.YNc(25,I,3,3,"th",17),t.YNc(26,J,3,3,"td",18),t.BQk(),t.ynx(27,20),t.YNc(28,G,2,1,"th",21),t.BQk(),t.ynx(29,22),t.YNc(30,K,1,0,"th",23),t.BQk(),t.ynx(31,24),t.YNc(32,W,1,0,"th",23),t.BQk(),t.ynx(33,25),t.YNc(34,V,1,0,"th",23),t.BQk(),t.ynx(35,26),t.YNc(36,q,2,4,"td",27),t.BQk(),t.YNc(37,tt,1,0,"tr",28),t.YNc(38,et,1,0,"tr",29),t.YNc(39,ot,1,0,"tr",30),t.YNc(40,nt,1,0,"tr",31),t.qZA()(),t.YNc(41,st,2,0,"div",32),t.ALo(42,"async")),2&n&&(t.xp6(5),t.hij(" ",t.lcZ(6,12,"CUSTOMER_PAYMENT_REPORT")," "),t.xp6(6),t.hij(" ",t.lcZ(12,14,"DOWNLOAD_REPORT")," "),t.xp6(3),t.Q6J("dir",i.langDir)("dataSource",i.dataSource),t.xp6(23),t.Q6J("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",i.displayedColumns),t.xp6(1),t.Q6J("matHeaderRowDef",t.DdM(18,rt))("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matFooterRowDef",i.columnsToDisplay)("matFooterRowDefSticky",!0),t.xp6(1),t.Q6J("ngIf",t.lcZ(42,16,i.dataSource.loading$)))},dependencies:[p.O5,h.yS,A.Fj,A.JJ,A.On,Y.Lv,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.mD,m.Ke,m.ge,m.ev,m.yh,m.XQ,m.Gk,m.Q2,C.NW,f.YE,O.Ou,p.Ov,N.R,B.X$]}),e})(),data:{claimType:"REP_CUST_PAYMENT_REP"},canActivate:[s(319).a]}];let ct=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[h.Bz.forChild(mt),h.Bz]}),e})();var ut=s(7108);let lt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[p.ez,ct,A.u5,ut.m,m.p0,C.TU,f.JX,O.Cq]}),e})()},8708:(T,d,s)=>{s.d(d,{R:()=>f});var p=s(5e3),h=s(9808),C=s(130);let f=(()=>{class c{constructor(o,a){this.currencyPipe=o,this.securityService=a}transform(o,a){return this.currencyPipe.transform(o=null!=o?o:0,this.securityService.currencyCode)}}return c.\u0275fac=function(o){return new(o||c)(p.Y36(h.H9,16),p.Y36(C.I,16))},c.\u0275pipe=p.Yjl({name:"customCurrency",type:c,pure:!0}),c})()}}]);