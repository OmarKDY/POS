"use strict";(self.webpackChunkposadminportal=self.webpackChunkposadminportal||[]).push([[8522],{8522:(tn,j,i)=>{i.r(j),i.d(j,{PurchaseOrderReturnModule:()=>Gr});var p=i(9808),u=i(3075),ne=i(7108),ae=i(6856),C=i(508),oe=i(7531),ie=i(7322),se=i(9814),M=i(4107),ue=i(9224),Z=i(2181),R=i(5245),P=i(7423),N=i(1079),A=i(773),O=i(1122),ce=i(7446),B=i(4834),$=i(2349),h=i(2554),I=i(319),V=i(9147),le=i(8408),H=i(9117),k=i(8489),G=i(1798),m=i(1777),D=i(6087),v=i(4847),U=i(2667),T=i(2023),pe=i(8929),de=i(6787),he=i(567),_=i(13),g=i(5778),f=i(7545),L=i(2868),y=i(1490),me=i(6414),_e=i(7854),ge=i(1421),e=i(5e3),b=i(9822),z=i(5803),fe=i(5485),X=i(2290),S=i(6107),K=i(8265),W=i(9785),E=i(226),xe=i(2552),c=i(2075),q=i(8708),Y=i(1062);function Oe(t,n){1&t&&(e.TgZ(0,"div",21),e._UZ(1,"mat-spinner"),e.qZA())}function Te(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"PRODUCT_NAME")))}function Ze(t,n){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",r.productName," ")}}function Ae(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"SOURCE")))}function ve(t,n){1&t&&(e.TgZ(0,"ng-contaner"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"PURCHASE_ORDER_RETURN")," "))}function Ce(t,n){1&t&&(e.TgZ(0,"ng-contaner"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"PURCHASE_ORDER")," "))}function Re(t,n){if(1&t&&(e.TgZ(0,"td",23),e.YNc(1,ve,3,3,"ng-contaner",24),e.YNc(2,Ce,3,3,"ng-contaner",24),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.Q6J("ngIf",1==r.status),e.xp6(1),e.Q6J("ngIf",1!=r.status)}}function Pe(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"UNIT")," "))}function Ne(t,n){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",r.unitName," ")}}function Ie(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"UNIT_PER_PRICE")," "))}function De(t,n){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.ALo(2,"customCurrency"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r.unitPrice)," ")}}function Ue(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"QUANTITY")," "))}function Le(t,n){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",1===r.status?-1*r.quantity:r.quantity," ")}}function ye(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TOTAL_DISCOUNT")," "))}function be(t,n){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.ALo(2,"customCurrency"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.AsE(" ",e.lcZ(2,2,r.discount),"(",r.discountPercentage,"%) ")}}function Se(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TAX")," "))}function Ee(t,n){1&t&&(e.TgZ(0,"span"),e._uU(1," ,"),e.qZA())}function qe(t,n){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.YNc(2,Ee,2,0,"span",24),e.qZA()),2&t){const r=n.$implicit,a=n.last;e.xp6(1),e.AsE(" ",r.taxName,"(",r.taxPercentage,"%) "),e.xp6(1),e.Q6J("ngIf",!a)}}function Ye(t,n){if(1&t&&(e.TgZ(0,"td",23),e.YNc(1,qe,3,3,"span",25),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.Q6J("ngForOf",r.purchaseOrderItemTaxes)}}function Qe(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TOTAL_TAX"),""))}function Fe(t,n){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.ALo(2,"customCurrency"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r.taxValue)," ")}}function Je(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TOTAL")," "))}function we(t,n){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.ALo(2,"customCurrency"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r.unitPrice*r.quantity-r.discount+r.taxValue)," ")}}function je(t,n){1&t&&(e.TgZ(0,"th",22),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"WAREHOUSE"),""))}function Me(t,n){if(1&t&&(e.TgZ(0,"td",23),e._uU(1),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",r.warehouseName," ")}}function Be(t,n){1&t&&e._UZ(0,"tr",26)}function $e(t,n){1&t&&e._UZ(0,"tr",27)}let Ve=(()=>{class t extends y.H{constructor(r,a){super(a),this.purchaseOrderService=r,this.translationService=a,this.purchaseOrderItems=[],this.isLoading=!1,this.displayedColumns=["productName","source","unitName","unitPrice","quantity","totalDiscount","taxes","totalTax","totalAmount","warehouse"],this.getLangDir()}ngOnInit(){}ngOnChanges(r){r.purchaseOrder&&this.getPurchaseOrderItems()}getPurchaseOrderItems(){this.isLoading=!0,this.purchaseOrderService.getPurchaseOrderItems(this.purchaseOrder.id,!0).subscribe(r=>{this.isLoading=!1,this.purchaseOrderItems=r},()=>this.isLoading=!1)}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(b.x),e.Y36(S.D))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-purchase-order-return-item"]],inputs:{purchaseOrder:"purchaseOrder"},features:[e.qOj,e.TTD],decls:42,vars:9,consts:[[1,"page-header-main"],[1,"row","align-items-center"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],["class","loading-shade",4,"ngIf"],[1,"table-responsive"],["mat-table","",1,"table","table-bordered","table-hover",3,"dir","dataSource"],["matColumnDef","productName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","source"],["matColumnDef","unitName"],["matColumnDef","unitPrice"],["matColumnDef","quantity"],["matColumnDef","totalDiscount"],["matColumnDef","taxes"],["matColumnDef","totalTax"],["matColumnDef","totalAmount"],["matColumnDef","warehouse"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"loading-shade"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],[4,"ngFor","ngForOf"],["mat-header-row",""],["mat-row",""]],template:function(r,a){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),e._uU(5),e.ALo(6,"translate"),e.qZA()()()()(),e.YNc(7,Oe,2,0,"div",4),e.TgZ(8,"div",5)(9,"table",6),e.ynx(10,7),e.YNc(11,Te,3,3,"th",8),e.YNc(12,Ze,2,1,"td",9),e.BQk(),e.ynx(13,10),e.YNc(14,Ae,3,3,"th",8),e.YNc(15,Re,3,2,"td",9),e.BQk(),e.ynx(16,11),e.YNc(17,Pe,3,3,"th",8),e.YNc(18,Ne,2,1,"td",9),e.BQk(),e.ynx(19,12),e.YNc(20,Ie,3,3,"th",8),e.YNc(21,De,3,3,"td",9),e.BQk(),e.ynx(22,13),e.YNc(23,Ue,3,3,"th",8),e.YNc(24,Le,2,1,"td",9),e.BQk(),e.ynx(25,14),e.YNc(26,ye,3,3,"th",8),e.YNc(27,be,3,4,"td",9),e.BQk(),e.ynx(28,15),e.YNc(29,Se,3,3,"th",8),e.YNc(30,Ye,2,1,"td",9),e.BQk(),e.ynx(31,16),e.YNc(32,Qe,3,3,"th",8),e.YNc(33,Fe,3,3,"td",9),e.BQk(),e.ynx(34,17),e.YNc(35,Je,3,3,"th",8),e.YNc(36,we,3,3,"td",9),e.BQk(),e.ynx(37,18),e.YNc(38,je,3,3,"th",8),e.YNc(39,Me,2,1,"td",9),e.BQk(),e.YNc(40,Be,1,0,"tr",19),e.YNc(41,$e,1,0,"tr",20),e.qZA()()),2&r&&(e.xp6(5),e.Oqu(e.lcZ(6,7,"PURCHASE_ORDER_RETURN_ITEMS")),e.xp6(2),e.Q6J("ngIf",a.isLoading),e.xp6(2),e.Q6J("dir",a.langDir)("dataSource",a.purchaseOrderItems),e.xp6(31),e.Q6J("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",a.displayedColumns))},dependencies:[p.sg,p.O5,E.Lv,A.Ou,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,q.R,Y.X$]}),t})();var He=i(8017),ke=i(2989);const Ge=function(){return["/purchase-order-return/add"]};function ze(t,n){1&t&&(e.TgZ(0,"button",50),e._UZ(1,"i",51),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&t&&(e.Q6J("routerLink",e.DdM(4,Ge)),e.xp6(2),e.hij(" ",e.lcZ(3,2,"ADD_PURCHASE_ORDER_RETURN")," "))}function Xe(t,n){1&t&&(e.TgZ(0,"div",52),e._UZ(1,"mat-spinner"),e.qZA())}function Ke(t,n){1&t&&e._UZ(0,"th",53)}function We(t,n){1&t&&(e.TgZ(0,"mat-icon"),e._uU(1,"chevron_right"),e.qZA())}function et(t,n){1&t&&(e.TgZ(0,"mat-icon"),e._uU(1,"expand_more"),e.qZA())}function tt(t,n){if(1&t&&(e.TgZ(0,"button",60)(1,"mat-icon"),e._uU(2,"more_vert"),e.qZA()()),2&t){e.oxw();const r=e.MAs(6);e.Q6J("matMenuTriggerFor",r)}}const ee=function(t){return["/purchase-order/detail",t]};function rt(t,n){if(1&t&&(e.TgZ(0,"button",61)(1,"mat-icon"),e._uU(2,"info"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()),2&t){const r=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(4,ee,r.id)),e.xp6(4),e.Oqu(e.lcZ(5,2,"DETAIL"))}}function nt(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"button",62),e.NdJ("click",function(){e.CHM(r);const o=e.oxw(2).$implicit,s=e.oxw();return e.KtG(s.addPayment(o))}),e.TgZ(1,"mat-icon"),e._uU(2,"payment"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"ADD_PAYMENT")))}function at(t,n){1&t&&(e.TgZ(0,"ng-contaner"),e.YNc(1,nt,6,3,"button",59),e.qZA()),2&t&&(e.xp6(1),e.Q6J("hasClaim","PO_ADD_PO_PAYMENT"))}function ot(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"button",62),e.NdJ("click",function(){e.CHM(r);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.viewPayment(o))}),e.TgZ(1,"mat-icon"),e._uU(2,"view_carousel"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"VIEW_PAYMENT")))}function it(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"button",62),e.NdJ("click",function(){e.CHM(r);const o=e.oxw().$implicit,s=e.oxw();return e.KtG(s.generateInvoice(o))}),e.TgZ(1,"mat-icon"),e._uU(2,"receipt"),e.qZA(),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"translate"),e.qZA()()}2&t&&(e.xp6(4),e.Oqu(e.lcZ(5,1,"GENERATE_INVOICE")))}const st=function(){return["PO_UPDATE_PO","PO_VIEW_PO_DETAIL","PO_DELETE_PO","PO_RETURN_PO","PO_ADD_PO_PAYMENT","PO_VIEW_PO_PAYMENTS","PO_GENERATE_INVOICE"]};function ut(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"td",54)(1,"button",55),e.NdJ("click",function(){const s=e.CHM(r).$implicit,l=e.oxw();return e.KtG(l.toggleRow(s))}),e.YNc(2,We,2,0,"mat-icon",49),e.YNc(3,et,2,0,"mat-icon",49),e.qZA(),e.YNc(4,tt,3,1,"button",56),e.TgZ(5,"mat-menu",null,57),e.YNc(7,rt,6,6,"button",58),e.YNc(8,at,2,1,"ng-contaner",49),e.YNc(9,ot,6,3,"button",59),e.YNc(10,it,6,3,"button",59),e.qZA()()}if(2&t){const r=n.$implicit,a=e.oxw();e.xp6(2),e.Q6J("ngIf",r!=a.expandedElement),e.xp6(1),e.Q6J("ngIf",r==a.expandedElement),e.xp6(1),e.Q6J("hasClaim",e.DdM(7,st)),e.xp6(3),e.Q6J("hasClaim","PO_VIEW_PO_DETAIL"),e.xp6(1),e.Q6J("ngIf",0!=r.paymentStatus),e.xp6(1),e.Q6J("hasClaim","PO_VIEW_PO_PAYMENTS"),e.xp6(1),e.Q6J("hasClaim","PO_GENERATE_INVOICE")}}function ct(t,n){1&t&&(e.TgZ(0,"th",63),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"CREATED_DATE")," "))}function lt(t,n){if(1&t&&(e.TgZ(0,"td",64),e._uU(1),e.ALo(2,"utcToLocalTime"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,r.poCreatedDate,"shortDate")," ")}}function pt(t,n){1&t&&(e.TgZ(0,"th",65),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ORDER_NUMBER")," "))}function dt(t,n){if(1&t&&(e.TgZ(0,"td",54)(1,"a",66),e._uU(2),e.qZA()()),2&t){const r=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,ee,r.id)),e.xp6(1),e.hij("",r.orderNumber," ")}}function ht(t,n){1&t&&(e.TgZ(0,"th",65),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DELIVERY_DATE")," "))}function mt(t,n){if(1&t&&(e.TgZ(0,"td",64),e._uU(1),e.ALo(2,"utcToLocalTime"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,r.deliveryDate,"shortDate")," ")}}function _t(t,n){1&t&&(e.TgZ(0,"th",67),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SUPPLIER_NAME")," "))}const gt=function(t){return["/supplier/manage/",t]};function ft(t,n){if(1&t&&(e.TgZ(0,"td",68)(1,"a",66),e._uU(2),e.qZA()()),2&t){const r=n.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(2,gt,r.supplierId)),e.xp6(1),e.hij(" ",r.supplierName," ")}}function xt(t,n){1&t&&(e.TgZ(0,"th",69),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TOTAL_DISCOUNT")," "))}function Ot(t,n){if(1&t&&(e.TgZ(0,"td",70),e._uU(1),e.ALo(2,"customCurrency"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r.totalDiscount)," ")}}function Tt(t,n){1&t&&(e.TgZ(0,"th",69),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TOTAL_TAX")," "))}function Zt(t,n){if(1&t&&(e.TgZ(0,"td",70),e._uU(1),e.ALo(2,"customCurrency"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r.totalTax)," ")}}function At(t,n){1&t&&(e.TgZ(0,"th",69),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TOTAL_AMOUNT")," "))}function vt(t,n){if(1&t&&(e.TgZ(0,"td",70),e._uU(1),e.ALo(2,"customCurrency"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r.totalAmount)," ")}}function Ct(t,n){1&t&&(e.TgZ(0,"th",69),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TOTAL_PAID_AMOUNT")," "))}function Rt(t,n){if(1&t&&(e.TgZ(0,"td",70),e._uU(1),e.ALo(2,"customCurrency"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r.totalPaidAmount)," ")}}function Pt(t,n){1&t&&(e.TgZ(0,"th",69),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"PAYMENT_STATUS")," "))}const Nt=function(t,n,r){return{"badge-success":t,"badge-danger":n,"badge-warning":r}};function It(t,n){if(1&t&&(e.TgZ(0,"td",71)(1,"span",72),e._uU(2),e.ALo(3,"paymentStatus"),e.qZA()()),2&t){const r=n.$implicit;e.xp6(1),e.Q6J("ngClass",e.kEZ(4,Nt,0==r.paymentStatus,1==r.paymentStatus,2==r.paymentStatus)),e.xp6(1),e.hij(" ",e.lcZ(3,2,r.paymentStatus),"")}}function Dt(t,n){1&t&&e._UZ(0,"th",73)}function Ut(t,n){1&t&&e._UZ(0,"th",73)}function Lt(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"th",73)(1,"input",74),e.NdJ("ngModelChange",function(o){e.CHM(r);const s=e.oxw();return e.KtG(s.OrderNumberFilter=o)}),e.ALo(2,"translate"),e.qZA()()}if(2&t){const r=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(2,2,"ORDER_NO")),e.Q6J("ngModel",r.OrderNumberFilter)}}function yt(t,n){1&t&&e._UZ(0,"th",73)}function bt(t,n){if(1&t&&(e.TgZ(0,"mat-option",80),e._uU(1),e.qZA()),2&t){const r=n.$implicit,a=e.oxw(2);e.Q6J("dir",a.langDir)("value",r.supplierName),e.xp6(1),e.hij(" ",r.supplierName," ")}}function St(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"th",73),e._UZ(1,"input",75),e.ALo(2,"translate"),e.TgZ(3,"mat-autocomplete",76,77),e.NdJ("optionSelected",function(o){e.CHM(r);const s=e.oxw();return e.KtG(s.SupplierFilter=o.option.value)}),e.TgZ(5,"mat-option",78),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.YNc(8,bt,2,3,"mat-option",79),e.ALo(9,"async"),e.qZA()()}if(2&t){const r=e.MAs(4),a=e.oxw();e.xp6(1),e.s9C("placeholder",e.lcZ(2,7,"SUPPLIER")),e.Q6J("formControl",a.supplierNameControl)("matAutocomplete",r),e.xp6(2),e.Q6J("dir",a.langDir)("autoActiveFirstOption",!0),e.xp6(3),e.Oqu(e.lcZ(7,9,"NONE")),e.xp6(2),e.Q6J("ngForOf",e.lcZ(9,11,a.supplierList$))}}function Et(t,n){1&t&&e._UZ(0,"th",73)}function qt(t,n){1&t&&e._UZ(0,"th",73)}function Yt(t,n){1&t&&e._UZ(0,"th",73)}function Qt(t,n){1&t&&e._UZ(0,"th",73)}function Ft(t,n){1&t&&e._UZ(0,"th",73)}const Jt=function(){return[10,20,30]};function wt(t,n){if(1&t&&(e.TgZ(0,"td",81),e._UZ(1,"mat-paginator",82),e.qZA()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("dir",r.langDir)("length",r.purchaseOrderResource.totalCount)("pageSize",r.purchaseOrderResource.pageSize)("pageSizeOptions",e.DdM(4,Jt))}}function jt(t,n){if(1&t&&(e.ynx(0),e.TgZ(1,"div",83)(2,"div",84),e._UZ(3,"app-purchase-order-return-item",85),e.qZA()(),e.BQk()),2&t){const r=e.oxw().$implicit,a=e.oxw();e.xp6(1),e.Q6J("@detailExpand",r==a.expandedElement?"expanded":"collapsed"),e.xp6(2),e.Q6J("purchaseOrder",r)}}function Mt(t,n){if(1&t&&(e.TgZ(0,"td",70),e.YNc(1,jt,4,2,"ng-container",49),e.qZA()),2&t){const r=n.$implicit,a=e.oxw();e.uIk("colspan",a.displayedColumns.length),e.xp6(1),e.Q6J("ngIf",r==a.expandedElement)}}function Bt(t,n){1&t&&(e.TgZ(0,"tr")(1,"td",86)(2,"span",87)(3,"b"),e._uU(4),e.ALo(5,"translate"),e.qZA()()()()),2&t&&(e.xp6(4),e.hij(" ",e.lcZ(5,1,"NO_DATA_FOUND"),""))}function $t(t,n){1&t&&e._UZ(0,"tr",88)}function Vt(t,n){1&t&&e._UZ(0,"tr",89)}function Ht(t,n){1&t&&e._UZ(0,"tr",88)}function kt(t,n){1&t&&e._UZ(0,"tr",90)}function Gt(t,n){1&t&&e._UZ(0,"tr",91)}function zt(t,n){1&t&&(e.ynx(0),e.TgZ(1,"div",6)(2,"div",92)(3,"label",93),e._uU(4),e.ALo(5,"translate"),e.qZA()()(),e.BQk()),2&t&&(e.xp6(4),e.hij(" ",e.lcZ(5,1,"NO_DATA_FOUND"),""))}function Xt(t,n){if(1&t&&(e.ynx(0),e._UZ(1,"app-purchase-order-invoice",85),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("purchaseOrder",r.purchaseOrderForInvoice)}}const Kt=function(){return["expandedDetail"]};let Wt=(()=>{class t extends y.H{constructor(r,a,o,s,l,d,x,J,w){super(x),this.purchaseOrderService=r,this.supplierService=a,this.cd=o,this.commonDialogService=s,this.toastrService=l,this.router=d,this.translationService=x,this.dialog=J,this.clonerService=w,this.purchaseOrders=[],this.displayedColumns=["action","poCreatedDate","orderNumber","deliveryDate","supplierName","totalDiscount","totalTax","totalAmount","totalPaidAmount","paymentStatus"],this.filterColumns=["action-search","poCreatedDate-search","orderNumber-search","deliverDate-search","supplier-search","totalAmount-search","totalDiscount-search","totalTax-search","totalPaidAmount-search","paymentStatus-search"],this.footerToDisplayed=["footer"],this.isLoadingResults=!0,this.supplierNameControl=new u.p4,this.filterObservable$=new pe.xQ,this.getLangDir(),this.purchaseOrderResource=new U.D,this.purchaseOrderResource.pageSize=50,this.purchaseOrderResource.orderBy="poCreatedDate asc",this.purchaseOrderResource.isPurchaseOrderRequest=!1,this.purchaseOrderResource.status=T.G.Return}get SupplierFilter(){return this._supplierFilter}set SupplierFilter(r){this._supplierFilter=r,this.filterObservable$.next(`supplierName:${r}`)}get OrderNumberFilter(){return this._orderNumberFilter}set OrderNumberFilter(r){this._orderNumberFilter=r,this.filterObservable$.next(`orderNumber:${r}`)}ngOnInit(){this.supplierNameControlOnChange(),this.dataSource=new _e.w(this.purchaseOrderService),this.dataSource.loadData(this.purchaseOrderResource),this.getResourceParameter(),this.sub$.sink=this.filterObservable$.pipe((0,_.b)(1e3),(0,g.x)()).subscribe(r=>{this.purchaseOrderResource.skip=0,this.paginator.pageIndex=0;const a=r.split(":");"supplierName"===a[0]?this.purchaseOrderResource.supplierName=a[1]:"orderNumber"===a[0]&&(this.purchaseOrderResource.orderNumber=a[1]),this.dataSource.loadData(this.purchaseOrderResource)})}supplierNameControlOnChange(){this.supplierList$=this.supplierNameControl.valueChanges.pipe((0,_.b)(1e3),(0,g.x)(),(0,f.w)(r=>this.supplierService.getSuppliersForDropDown(r)))}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,de.T)(this.sort.sortChange,this.paginator.page).pipe((0,L.b)(r=>{this.purchaseOrderResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.purchaseOrderResource.pageSize=this.paginator.pageSize,this.purchaseOrderResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadData(this.purchaseOrderResource)})).subscribe()}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(r=>{r&&(this.purchaseOrderResource.pageSize=r.pageSize,this.purchaseOrderResource.skip=r.skip,this.purchaseOrderResource.totalCount=r.totalCount)})}toggleRow(r){this.expandedElement=this.expandedElement===r?null:r,this.cd.detectChanges()}poChangeEvent(r){this.toggleRow(r)}deletePurchaseOrder(r){this.commonDialogService.deleteConformationDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")).subscribe(a=>{a&&this.purchaseOrderService.deletePurchaseOrder(r.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("PURCHASE_ORDER_DELETED_SUCCESSFULLY")),this.dataSource.loadData(this.purchaseOrderResource)})})}addPayment(r){this.dialog.open(me.H,{width:"100vh",direction:this.langDir,data:Object.assign({},r)}).afterClosed().subscribe(o=>{o&&this.dataSource.loadData(this.purchaseOrderResource)})}viewPayment(r){this.dialog.open(ge.l,{data:Object.assign({},r),direction:this.langDir}).afterClosed().subscribe(o=>{o&&this.dataSource.loadData(this.purchaseOrderResource)})}OnPurchaseOrderReturn(r){this.router.navigate(["/purchase-order-return",r.id])}generateInvoice(r){let a=this.clonerService.deepClone(r);const o=this.supplierService.getSupplier(r.supplierId),s=this.purchaseOrderService.getPurchaseOrderItems(r.id);(0,he.D)({getSupplierRequest:o,getPurchaseOrderItems:s}).subscribe(l=>{a.supplier=l.getSupplierRequest,a.purchaseOrderItems=l.getPurchaseOrderItems,this.purchaseOrderForInvoice=a})}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(b.x),e.Y36(z.p),e.Y36(e.sBO),e.Y36(fe.V),e.Y36(X._W),e.Y36(h.F0),e.Y36(S.D),e.Y36($.uw),e.Y36(K.$))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-purchase-order-return-list"]],viewQuery:function(r,a){if(1&r&&(e.Gf(D.NW,5),e.Gf(v.YE,5)),2&r){let o;e.iGM(o=e.CRH())&&(a.paginator=o.first),e.iGM(o=e.CRH())&&(a.sort=o.first)}},features:[e.qOj],decls:77,vars:20,consts:[[1,"page-header-main"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],["class","btn blue-btn btn-sm m-right-10",3,"routerLink",4,"hasClaim"],["class","loading-shade",4,"ngIf"],[1,"row"],[1,"col-sm-12"],[1,"table-responsive"],["mat-table","","multiTemplateDataRows","","matSort","","matSortActive","poCreatedDate",1,"table","table-bordered","table-hover","grid-height",3,"dir","dataSource"],["matColumnDef","action"],["class","table-column-150","mat-header-cell","",4,"matHeaderCellDef"],["class","table-column-150","mat-cell","",4,"matCellDef"],["matColumnDef","poCreatedDate"],["class","table-column-100","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-100","mat-cell","",4,"matCellDef"],["matColumnDef","orderNumber"],["class","table-column-150","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","deliveryDate"],["matColumnDef","supplierName"],["class","table-column-300","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-300","mat-cell","",4,"matCellDef"],["matColumnDef","totalDiscount"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","totalTax"],["matColumnDef","totalAmount"],["matColumnDef","totalPaidAmount"],["matColumnDef","paymentStatus"],["mat-cell","","style","text-align: center;",4,"matCellDef"],["matColumnDef","action-search"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","poCreatedDate-search"],["matColumnDef","orderNumber-search"],["matColumnDef","deliverDate-search"],["matColumnDef","supplier-search"],["matColumnDef","totalAmount-search"],["matColumnDef","totalDiscount-search"],["matColumnDef","totalTax-search"],["matColumnDef","totalPaidAmount-search"],["matColumnDef","paymentStatus-search"],["matColumnDef","footer"],["mat-footer-cell","","colspan","12",4,"matFooterCellDef"],["matColumnDef","expandedDetail"],[4,"matNoDataRow"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[1,"btn","blue-btn","btn-sm","m-right-10",3,"routerLink"],[1,"fas","fa-plus"],[1,"loading-shade"],["mat-header-cell","",1,"table-column-150"],["mat-cell","",1,"table-column-150"],["mat-icon-button","",3,"click"],["class","ml-4","mat-icon-button","","aria-label","Action",3,"matMenuTriggerFor",4,"hasClaim"],["menu","matMenu"],["mat-menu-item","",3,"routerLink",4,"hasClaim"],["mat-menu-item","",3,"click",4,"hasClaim"],["mat-icon-button","","aria-label","Action",1,"ml-4",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"],["mat-header-cell","","mat-sort-header","",1,"table-column-100"],["mat-cell","",1,"table-column-100"],["mat-header-cell","","mat-sort-header","",1,"table-column-150"],[3,"routerLink"],["mat-header-cell","","mat-sort-header","",1,"table-column-300"],["mat-cell","",1,"table-column-300"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",2,"text-align","center"],[1,"badge-pill",3,"ngClass"],["mat-header-cell",""],["type","text",1,"form-control","w-90",3,"placeholder","ngModel","ngModelChange"],["type","text",1,"form-control","w-90",3,"placeholder","formControl","matAutocomplete"],[3,"dir","autoActiveFirstOption","optionSelected"],["autoSupplier","matAutocomplete"],["value",""],[3,"dir","value",4,"ngFor","ngForOf"],[3,"dir","value"],["mat-footer-cell","","colspan","12"],[3,"dir","length","pageSize","pageSizeOptions"],[1,"example-element-detail"],[1,"inner-table","mat-elevation-z8"],[3,"purchaseOrder"],["colspan","8"],[1,"p-4","mt-4"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],["mat-row","",1,"example-detail-row"],[1,"col-sm-12","ml-4","mt-3"],[1,"font-weight-bold"]],template:function(r,a){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),e._uU(5),e.ALo(6,"translate"),e.qZA()()(),e.TgZ(7,"div",2),e.YNc(8,ze,4,5,"button",4),e.qZA()()(),e.YNc(9,Xe,2,0,"div",5),e.ALo(10,"async"),e.TgZ(11,"div",6)(12,"div",7)(13,"div",8)(14,"table",9),e.ynx(15,10),e.YNc(16,Ke,1,0,"th",11),e.YNc(17,ut,11,8,"td",12),e.BQk(),e.ynx(18,13),e.YNc(19,ct,3,3,"th",14),e.YNc(20,lt,3,4,"td",15),e.BQk(),e.ynx(21,16),e.YNc(22,pt,3,3,"th",17),e.YNc(23,dt,3,4,"td",12),e.BQk(),e.ynx(24,18),e.YNc(25,ht,3,3,"th",17),e.YNc(26,mt,3,4,"td",15),e.BQk(),e.ynx(27,19),e.YNc(28,_t,3,3,"th",20),e.YNc(29,ft,3,4,"td",21),e.BQk(),e.ynx(30,22),e.YNc(31,xt,3,3,"th",23),e.YNc(32,Ot,3,3,"td",24),e.BQk(),e.ynx(33,25),e.YNc(34,Tt,3,3,"th",23),e.YNc(35,Zt,3,3,"td",24),e.BQk(),e.ynx(36,26),e.YNc(37,At,3,3,"th",23),e.YNc(38,vt,3,3,"td",24),e.BQk(),e.ynx(39,27),e.YNc(40,Ct,3,3,"th",23),e.YNc(41,Rt,3,3,"td",24),e.BQk(),e.ynx(42,28),e.YNc(43,Pt,3,3,"th",23),e.YNc(44,It,4,8,"td",29),e.BQk(),e.ynx(45,30),e.YNc(46,Dt,1,0,"th",31),e.BQk(),e.ynx(47,32),e.YNc(48,Ut,1,0,"th",31),e.BQk(),e.ynx(49,33),e.YNc(50,Lt,3,4,"th",31),e.BQk(),e.ynx(51,34),e.YNc(52,yt,1,0,"th",31),e.BQk(),e.ynx(53,35),e.YNc(54,St,10,13,"th",31),e.BQk(),e.ynx(55,36),e.YNc(56,Et,1,0,"th",31),e.BQk(),e.ynx(57,37),e.YNc(58,qt,1,0,"th",31),e.BQk(),e.ynx(59,38),e.YNc(60,Yt,1,0,"th",31),e.BQk(),e.ynx(61,39),e.YNc(62,Qt,1,0,"th",31),e.BQk(),e.ynx(63,40),e.YNc(64,Ft,1,0,"th",31),e.BQk(),e.ynx(65,41),e.YNc(66,wt,2,5,"td",42),e.BQk(),e.ynx(67,43),e.YNc(68,Mt,2,2,"td",24),e.BQk(),e.YNc(69,Bt,6,3,"tr",44),e.YNc(70,$t,1,0,"tr",45),e.YNc(71,Vt,1,0,"tr",46),e.YNc(72,Ht,1,0,"tr",45),e.YNc(73,kt,1,0,"tr",47),e.YNc(74,Gt,1,0,"tr",48),e.qZA(),e.YNc(75,zt,6,3,"ng-container",49),e.qZA()()(),e.YNc(76,Xt,2,1,"ng-container",49)),2&r&&(e.xp6(5),e.Oqu(e.lcZ(6,15,"PURCHASE_ORDER_RETURN")),e.xp6(3),e.Q6J("hasClaim","PO_ADD_PO"),e.xp6(1),e.Q6J("ngIf",e.lcZ(10,17,a.dataSource.loading$)),e.xp6(5),e.Q6J("dir",a.langDir)("dataSource",a.dataSource),e.xp6(56),e.Q6J("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",a.displayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",a.filterColumns)("matHeaderRowDefSticky",!0),e.xp6(1),e.Q6J("matFooterRowDef",a.footerToDisplayed)("matFooterRowDefSticky",!0),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(19,Kt)),e.xp6(1),e.Q6J("ngIf",0===a.dataSource.count),e.xp6(1),e.Q6J("ngIf",a.purchaseOrderForInvoice))},dependencies:[p.mk,p.sg,p.O5,u.Fj,u.JJ,u.On,u.oH,W.d,E.Lv,xe.g,C.ey,Z.VK,Z.OP,Z.p6,R.Hw,P.lW,N.XC,N.ZL,A.Ou,h.rH,h.yS,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.mD,c.Ke,c.ge,c.ev,c.yh,c.XQ,c.Gk,c.Q2,c.Ee,D.NW,v.YE,v.nU,Ve,p.Ov,q.R,He.M,Y.X$,ke.r],data:{animation:[(0,m.X$)("detailExpand",[(0,m.SB)("collapsed",(0,m.oB)({height:"0px",minHeight:"0"})),(0,m.SB)("expanded",(0,m.oB)({height:"*"})),(0,m.eR)("expanded <=> collapsed",(0,m.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),t})();var er=i(3007),tr=i(796),rr=i(2754),Q=i(6521),F=i(6695),nr=i(690),ar=i(6018),or=i(5528);function ir(t,n){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const r=n.$implicit,a=e.oxw(2);e.Q6J("dir",a.langDir)("value",r.id),e.xp6(1),e.hij(" ",r.supplierName," ")}}function sr(t,n){1&t&&(e.TgZ(0,"mat-option",19),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"NONE")))}function ur(t,n){1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NO_RECORDS")," "))}function cr(t,n){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const r=n.$implicit,a=e.oxw(2);e.Q6J("dir",a.langDir)("value",r.id),e.xp6(1),e.hij(" ",r.orderNumber," ")}}function lr(t,n){1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NO_RECORDS")," "))}function pr(t,n){if(1&t&&(e.ynx(0),e.TgZ(1,"form",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"label"),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"div",10)(9,"mat-select",11),e.ALo(10,"translate"),e._UZ(11,"input",12),e.ALo(12,"translate"),e._UZ(13,"mat-divider"),e.YNc(14,ir,2,3,"mat-option",13),e.YNc(15,sr,3,3,"mat-option",14),e.YNc(16,ur,3,3,"mat-option",15),e.qZA()()()(),e.TgZ(17,"div",8)(18,"div",9)(19,"label"),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"div",10)(23,"mat-select",16),e.ALo(24,"translate"),e._UZ(25,"input",17),e.ALo(26,"translate"),e._UZ(27,"mat-divider"),e.YNc(28,cr,2,3,"mat-option",13),e.YNc(29,lr,3,3,"mat-option",15),e.qZA()()()()()(),e.BQk()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("formGroup",r.purchaseOrderReturnForm),e.xp6(5),e.Oqu(e.lcZ(7,14,"SELECT_SUPPLIER")),e.xp6(3),e.s9C("placeholder",e.lcZ(10,16,"SELECT_SUPPLIER")),e.Q6J("dir",r.langDir),e.xp6(2),e.s9C("placeholder",e.lcZ(12,18,"SEARCH_OTHER_SUPPLIERS")),e.xp6(3),e.Q6J("ngForOf",r.suppliersForSearch),e.xp6(1),e.Q6J("ngIf",r.suppliersForSearch.length>0),e.xp6(1),e.Q6J("ngIf",0==r.suppliersForSearch.length),e.xp6(4),e.hij("",e.lcZ(21,20,"SELECT_PURCHASE_ORDER")," "),e.xp6(3),e.s9C("placeholder",e.lcZ(24,22,"SELECT_PURCHASE_ORDER")),e.Q6J("dir",r.langDir),e.xp6(2),e.MGl("placeholder"," ",e.lcZ(26,24,"SEARCH_OTHER_PURCHASE_ORDER"),""),e.xp6(3),e.Q6J("ngForOf",r.purchaseorders),e.xp6(1),e.Q6J("ngIf",0==r.purchaseorders.length)}}function dr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"PO_ORDER_NUMBER_IS_REQUIRED")," "))}function hr(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,dr,3,3,"div",58),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==r.purchaseOrderForm.get("orderNumber").errors?null:r.purchaseOrderForm.get("orderNumber").errors.required)}}function mr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"ORDER_DATE_IS_REQUIRED")," "))}function _r(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,mr,3,3,"div",58),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==r.purchaseOrderForm.get("poCreatedDate").errors?null:r.purchaseOrderForm.get("poCreatedDate").errors.required)}}function gr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"DELIVERY_DATE_REQUIRED")," "))}function fr(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,gr,3,3,"div",58),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==r.purchaseOrderForm.get("deliveryDate").errors?null:r.purchaseOrderForm.get("deliveryDate").errors.required)}}function xr(t,n){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const r=n.$implicit,a=e.oxw(2);e.Q6J("dir",a.langDir)("value",r.id),e.xp6(1),e.hij(" ",r.supplierName," ")}}function Or(t,n){1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NO_RECORDS")," "))}function Tr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"SUPPLIER_NAME_IS_REQUIRED")," "))}function Zr(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,Tr,3,3,"div",58),e.qZA()),2&t){const r=e.oxw(2);e.xp6(1),e.Q6J("ngIf",null==r.purchaseOrderForm.get("supplierId").errors?null:r.purchaseOrderForm.get("supplierId").errors.required)}}function Ar(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"button",71),e.NdJ("click",function(){e.CHM(r);const o=e.oxw().index,s=e.oxw(2);return e.KtG(s.onRemovePurchaseOrderItem(o))}),e.TgZ(1,"mat-icon",72),e._uU(2,"delete_forever"),e.qZA()()}}function vr(t,n){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const r=n.$implicit,a=e.oxw(3);e.Q6J("dir",a.langDir)("value",r.id),e.xp6(1),e.hij(" ",r.name," ")}}function Cr(t,n){1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"NO_RECORDS")," "))}function Rr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"PRODUCT_IS_REQUIRED")," "))}function Pr(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,Rr,3,3,"div",58),e.qZA()),2&t){const r=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",null==r.get("productId").errors?null:r.get("productId").errors.required)}}function Nr(t,n){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&t){const r=n.$implicit;e.Q6J("value",r.id),e.xp6(1),e.hij(" ",r.name," ")}}function Ir(t,n){if(1&t&&(e.TgZ(0,"mat-option",18),e._uU(1),e.qZA()),2&t){const r=n.$implicit,a=e.oxw(3);e.Q6J("dir",a.langDir)("value",r.id),e.xp6(1),e.hij(" ",r.name," ")}}function Dr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"UNIT_IS_REQUIRED")," "))}function Ur(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,Dr,3,3,"div",58),e.qZA()),2&t){const r=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",null==r.get("unitPrice").errors?null:r.get("unitPrice").errors.required)}}function Lr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"QUANTITY_IS_REQUIRED")," "))}function yr(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,Lr,3,3,"div",58),e.qZA()),2&t){const r=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",null==r.get("quantity").errors?null:r.get("quantity").errors.required)}}function br(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"QUANTITY_IS_REQUIRED")," "))}function Sr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"QUANTITY_IS_MAX")," "))}function Er(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"QUANTITY_IS_MIN")," "))}function qr(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,br,3,3,"div",58),e.YNc(2,Sr,3,3,"div",58),e.YNc(3,Er,3,3,"div",58),e.qZA()),2&t){const r=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",null==r.get("reurnquntity").errors?null:r.get("reurnquntity").errors.required),e.xp6(1),e.Q6J("ngIf",null==r.get("reurnquntity").errors?null:r.get("reurnquntity").errors.max),e.xp6(1),e.Q6J("ngIf",null==r.get("reurnquntity").errors?null:r.get("reurnquntity").errors.min)}}function Yr(t,n){if(1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"customCurrency"),e.ALo(4,"quantitiesunitpriceTax"),e.qZA()),2&t){const r=e.oxw().$implicit;e.xp6(1),e.AsE(" ",e.lcZ(2,2,"DISCOUNT_AMOUNT"),": ",e.lcZ(3,4,e.Dn7(4,6,r.get("reurnquntity").value,r.get("unitPrice").value,r.get("discountPercentage").value))," ")}}function Qr(t,n){if(1&t&&(e.TgZ(0,"mat-option",20),e._uU(1),e.qZA()),2&t){const r=n.$implicit;e.Q6J("value",r.id),e.xp6(1),e.AsE("",r.name," (",r.percentage,"%) ")}}function Fr(t,n){1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&t&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"TAX_IS_REQUIRED")," "))}function Jr(t,n){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,Fr,3,3,"div",58),e.qZA()),2&t){const r=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",null==r.get("taxValue").errors?null:r.get("taxValue").errors.required)}}const te=function(t,n,r,a,o){return[t,n,r,a,o]};function wr(t,n){if(1&t&&(e.TgZ(0,"div",23),e._uU(1),e.ALo(2,"translate"),e.ALo(3,"customCurrency"),e.ALo(4,"quantitiesunitpriceTax"),e.qZA()),2&t){const r=e.oxw(),a=r.$implicit,o=r.index,s=e.oxw(2);e.xp6(1),e.AsE(" ",e.lcZ(2,2,"TAX_AMOUNT"),":: ",e.lcZ(3,4,e.G7q(4,6,e.qbA(12,te,a.get("reurnquntity").value,a.get("unitPrice").value,a.get("discountPercentage").value,a.get("taxValue").value,s.taxsMap[o])))," ")}}function jr(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"tr",59)(1,"td"),e.YNc(2,Ar,3,0,"button",60),e.qZA(),e.TgZ(3,"td")(4,"mat-select",61),e.NdJ("selectionChange",function(o){const l=e.CHM(r).index,d=e.oxw(2);return e.KtG(d.onProductSelectionChange(o,l))}),e._UZ(5,"input",62)(6,"mat-divider"),e.YNc(7,vr,2,3,"mat-option",13),e.YNc(8,Cr,3,3,"mat-option",15),e.qZA(),e.YNc(9,Pr,2,1,"div",4),e.qZA(),e.TgZ(10,"td")(11,"mat-select",63),e.YNc(12,Nr,2,2,"mat-option",64),e.qZA()(),e.TgZ(13,"td")(14,"mat-select",65),e.YNc(15,Ir,2,3,"mat-option",13),e.qZA()(),e.TgZ(16,"td"),e._UZ(17,"input",66),e.ALo(18,"translate"),e.YNc(19,Ur,2,1,"div",4),e.qZA(),e.TgZ(20,"td"),e._UZ(21,"input",67),e.ALo(22,"translate"),e.YNc(23,yr,2,1,"div",4),e.qZA(),e.TgZ(24,"td")(25,"input",68),e.NdJ("change",function(){e.CHM(r);const o=e.oxw(2);return e.KtG(o.onQuantityChange())}),e.ALo(26,"translate"),e.qZA(),e.YNc(27,qr,4,3,"div",4),e.qZA(),e.TgZ(28,"td"),e._uU(29),e.ALo(30,"customCurrency"),e.ALo(31,"quantitiesunitprice"),e.qZA(),e.TgZ(32,"td")(33,"input",69),e.NdJ("change",function(){e.CHM(r);const o=e.oxw(2);return e.KtG(o.onDiscountChange())}),e.ALo(34,"translate"),e.qZA()(),e.TgZ(35,"td"),e._uU(36),e.ALo(37,"customCurrency"),e.ALo(38,"quantitiesunitprice"),e.YNc(39,Yr,5,10,"div",58),e.qZA(),e.TgZ(40,"td")(41,"mat-select",70),e.NdJ("selectionChange",function(){e.CHM(r);const o=e.oxw(2);return e.KtG(o.onTaxSelectionChange())}),e.YNc(42,Qr,2,3,"mat-option",64),e.qZA(),e.YNc(43,Jr,2,1,"div",4),e.qZA(),e.TgZ(44,"td"),e._uU(45),e.ALo(46,"customCurrency"),e.ALo(47,"quantitiesunitprice"),e.YNc(48,wr,5,18,"div",58),e.qZA()()}if(2&t){const r=n.$implicit,a=n.index,o=e.oxw(2);e.Q6J("formGroupName",a),e.xp6(2),e.Q6J("ngIf",1!==o.purchaseOrderItemsArray.length),e.xp6(2),e.Q6J("dir",o.langDir),e.xp6(3),e.Q6J("ngForOf",o.filterProductsMap[a]),e.xp6(1),e.Q6J("ngIf",0==o.filterProductsMap[a].length),e.xp6(1),e.Q6J("ngIf",r.get("productId").touched&&r.get("productId").errors),e.xp6(2),e.Q6J("dir",o.langDir),e.xp6(1),e.Q6J("ngForOf",o.warehouseMap[a]),e.xp6(2),e.Q6J("dir",o.langDir),e.xp6(1),e.Q6J("ngForOf",o.unitsMap[a]),e.xp6(2),e.s9C("placeholder",e.lcZ(18,24,"UNIT_PER_PRICE")),e.xp6(2),e.Q6J("ngIf",r.get("unitPrice").touched&&r.get("unitPrice").errors),e.xp6(2),e.s9C("placeholder",e.lcZ(22,26,"QUANTITY")),e.xp6(2),e.Q6J("ngIf",r.get("quantity").touched&&r.get("quantity").errors),e.xp6(2),e.s9C("placeholder",e.lcZ(26,28,"RETURN_QUANTITY")),e.xp6(2),e.Q6J("ngIf",r.get("reurnquntity").touched&&r.get("reurnquntity").errors),e.xp6(2),e.hij(" ",e.lcZ(30,30,e.xi3(31,32,r.get("reurnquntity").value,r.get("unitPrice").value))," "),e.xp6(4),e.s9C("placeholder",e.lcZ(34,35,"DISCOUNT")),e.xp6(3),e.hij(" ",e.lcZ(37,37,e.Dn7(38,39,r.get("reurnquntity").value,r.get("unitPrice").value,r.get("discountPercentage").value))," "),e.xp6(3),e.Q6J("ngIf",0!=r.get("discountPercentage").value),e.xp6(3),e.Q6J("ngForOf",o.taxsMap[a]),e.xp6(1),e.Q6J("ngIf",r.get("taxValue").touched&&r.get("taxValue").errors),e.xp6(2),e.hij(" ",e.lcZ(46,43,e.G7q(47,45,e.qbA(51,te,r.get("reurnquntity").value,r.get("unitPrice").value,r.get("discountPercentage").value,r.get("taxValue").value,o.taxsMap[a])))," "),e.xp6(3),e.Q6J("ngIf",r.get("taxValue").value)}}function Mr(t,n){1&t&&(e.TgZ(0,"button",73),e._UZ(1,"i",74),e._uU(2),e.ALo(3,"translate"),e.qZA()),2&t&&(e.xp6(2),e.hij(" ",e.lcZ(3,1,"RETURN"),""))}function Br(t,n){if(1&t){const r=e.EpF();e.ynx(0),e.TgZ(1,"form",21),e.NdJ("ngSubmit",function(){e.CHM(r);const o=e.oxw();return e.KtG(o.onPurchaseOrderSubmit())}),e.TgZ(2,"div",7)(3,"div",22)(4,"div",9)(5,"label",23),e._uU(6),e.ALo(7,"translate"),e.TgZ(8,"span"),e._uU(9,"*"),e.qZA()(),e._UZ(10,"input",24),e.YNc(11,hr,2,1,"div",4),e.qZA()(),e.TgZ(12,"div",25)(13,"div",9)(14,"label",26),e._uU(15),e.ALo(16,"translate"),e.qZA(),e._UZ(17,"input",27),e.ALo(18,"translate"),e.YNc(19,_r,2,1,"div",4),e._UZ(20,"owl-date-time",28,29),e.qZA()(),e.TgZ(22,"div",25)(23,"div",9)(24,"label",30),e._uU(25),e.ALo(26,"translate"),e.qZA(),e._UZ(27,"input",31),e.ALo(28,"translate"),e.YNc(29,fr,2,1,"div",4),e._UZ(30,"owl-date-time",28,32),e.qZA()()(),e.TgZ(32,"div",7)(33,"div",8)(34,"div",9)(35,"label",23),e._uU(36),e.ALo(37,"translate"),e.qZA(),e.TgZ(38,"div",10)(39,"mat-select",33),e._UZ(40,"input",34)(41,"mat-divider"),e.YNc(42,xr,2,3,"mat-option",13),e.YNc(43,Or,3,3,"mat-option",15),e.qZA()(),e.YNc(44,Zr,2,1,"div",4),e.qZA()()(),e.TgZ(45,"div",7)(46,"div",35)(47,"div",9)(48,"label"),e._uU(49),e.ALo(50,"translate"),e.qZA(),e.TgZ(51,"div",10)(52,"textarea",36),e._uU(53,"          "),e.qZA()()()()(),e.TgZ(54,"div",7)(55,"div",37)(56,"div",7)(57,"div",38)(58,"div",39)(59,"table",40)(60,"tr")(61,"th",41),e._uU(62," \xa0 "),e.qZA(),e.TgZ(63,"th",42),e._uU(64),e.ALo(65,"translate"),e.qZA(),e.TgZ(66,"th",42),e._uU(67),e.ALo(68,"translate"),e.qZA(),e.TgZ(69,"th",43),e._uU(70),e.ALo(71,"translate"),e.qZA(),e.TgZ(72,"th",44),e._uU(73),e.ALo(74,"translate"),e.qZA(),e.TgZ(75,"th",45),e._uU(76),e.ALo(77,"translate"),e.qZA(),e.TgZ(78,"th",45),e._uU(79),e.ALo(80,"translate"),e.qZA(),e.TgZ(81,"th",46),e._uU(82),e.ALo(83,"translate"),e.qZA(),e.TgZ(84,"th",46),e._uU(85),e.ALo(86,"translate"),e.qZA(),e.TgZ(87,"th",46),e._uU(88),e.ALo(89,"translate"),e.qZA(),e.TgZ(90,"th",47),e._uU(91),e.ALo(92,"translate"),e.qZA(),e.TgZ(93,"th",43),e._uU(94),e.ALo(95,"translate"),e.qZA()(),e.YNc(96,jr,49,57,"tr",48),e.qZA()()()()()(),e.TgZ(97,"div",49)(98,"div",50),e._uU(99),e.ALo(100,"translate"),e.qZA(),e.TgZ(101,"div",51),e._uU(102),e.ALo(103,"customCurrency"),e.qZA()(),e.TgZ(104,"div",7)(105,"div",50),e._uU(106),e.ALo(107,"translate"),e.qZA(),e.TgZ(108,"div",52),e._uU(109),e.ALo(110,"customCurrency"),e.qZA()(),e.TgZ(111,"div",7)(112,"div",50),e._uU(113),e.ALo(114,"translate"),e.qZA(),e.TgZ(115,"div",51),e._uU(116),e.ALo(117,"customCurrency"),e.qZA()(),e.TgZ(118,"div",7)(119,"div",53),e._UZ(120,"mat-divider"),e.qZA()(),e.TgZ(121,"div",7)(122,"div",50),e._uU(123),e.ALo(124,"translate"),e.qZA(),e.TgZ(125,"div",51),e._uU(126),e.ALo(127,"customCurrency"),e.qZA()(),e.TgZ(128,"div",7)(129,"div",54),e.YNc(130,Mr,4,3,"button",55),e.TgZ(131,"button",56),e.NdJ("click",function(){e.CHM(r);const o=e.oxw();return e.KtG(o.cancel())}),e._UZ(132,"i",57),e._uU(133),e.ALo(134,"translate"),e.qZA()()()(),e.BQk()}if(2&t){const r=e.MAs(21),a=e.MAs(31),o=e.oxw();e.xp6(1),e.Q6J("formGroup",o.purchaseOrderForm),e.xp6(5),e.hij("",e.lcZ(7,44,"PO_NUMBER")," "),e.xp6(4),e.Q6J("readonly",o.isEdit),e.xp6(1),e.Q6J("ngIf",o.purchaseOrderForm.get("orderNumber").touched&&o.purchaseOrderForm.get("orderNumber").errors),e.xp6(4),e.hij("",e.lcZ(16,46,"ORDER_DATE")," *"),e.xp6(2),e.s9C("placeholder",e.lcZ(18,48,"DELIVERY_DATE")),e.Q6J("owlDateTimeTrigger",r)("owlDateTime",r),e.xp6(2),e.Q6J("ngIf",o.purchaseOrderForm.get("poCreatedDate").touched&&o.purchaseOrderForm.get("poCreatedDate").errors),e.xp6(1),e.Q6J("pickerType","calendar"),e.xp6(5),e.hij("",e.lcZ(26,50,"DELIVERY_DATE")," *"),e.xp6(2),e.s9C("placeholder",e.lcZ(28,52,"DELIVERY_DATE")),e.Q6J("owlDateTimeTrigger",a)("owlDateTime",a),e.xp6(2),e.Q6J("ngIf",o.purchaseOrderForm.get("deliveryDate").touched&&o.purchaseOrderForm.get("deliveryDate").errors),e.xp6(1),e.Q6J("pickerType","calendar"),e.xp6(6),e.hij("",e.lcZ(37,54,"SUPPLIER_NAME")," *"),e.xp6(3),e.Q6J("dir",o.langDir),e.xp6(3),e.Q6J("ngForOf",o.suppliers),e.xp6(1),e.Q6J("ngIf",0==o.suppliers.length),e.xp6(1),e.Q6J("ngIf",o.purchaseOrderForm.get("supplierId").touched&&o.purchaseOrderForm.get("supplierId").errors),e.xp6(5),e.hij("",e.lcZ(50,56,"RETURN_NOTES")," "),e.xp6(15),e.hij(" ",e.lcZ(65,58,"PRODUCT")," "),e.xp6(3),e.hij(" ",e.lcZ(68,60,"WAREHOUSE")," "),e.xp6(3),e.hij(" ",e.lcZ(71,62,"UNIT")," "),e.xp6(3),e.hij(" ",e.lcZ(74,64,"PRICE")," "),e.xp6(3),e.hij(" ",e.lcZ(77,66,"QUANTITY")," "),e.xp6(3),e.hij(" ",e.lcZ(80,68,"RETURN_QUANTITY")," "),e.xp6(3),e.hij(" ",e.lcZ(83,70,"SUBTOTAL_BEFORE_DISCOUNT")," "),e.xp6(3),e.hij(" ",e.lcZ(86,72,"DISCOUNT"),"% "),e.xp6(3),e.hij(" ",e.lcZ(89,74,"SUBTOTAL_AFTER_DISCOUNT")," "),e.xp6(3),e.hij(" ",e.lcZ(92,76,"TAX")," "),e.xp6(3),e.hij(" ",e.lcZ(95,78,"TOTAL")," "),e.xp6(2),e.Q6J("ngForOf",null==o.purchaseOrderItemsArray?null:o.purchaseOrderItemsArray.controls),e.xp6(3),e.hij(" ",e.lcZ(100,80,"SUB_TOTAL_BEFORE_DISCOUNT"),": "),e.xp6(3),e.hij(" ",e.lcZ(103,82,o.totalBeforeDiscount)," "),e.xp6(4),e.hij(" ",e.lcZ(107,84,"TOTAL_DISCOUNT"),": "),e.xp6(3),e.hij(" ",e.lcZ(110,86,o.totalDiscount)," "),e.xp6(4),e.hij(" ",e.lcZ(114,88,"TOTAL_TAX"),": "),e.xp6(3),e.hij(" ",e.lcZ(117,90,o.totalTax)," "),e.xp6(7),e.hij(" ",e.lcZ(124,92,"GRAND_TOTAL")," : "),e.xp6(3),e.hij(" ",e.lcZ(127,94,o.grandTotal)," "),e.xp6(4),e.Q6J("hasClaim","PO_RETURN_PO"),e.xp6(3),e.hij(" ",e.lcZ(134,96,"CANCEL")," ")}}function $r(t,n){1&t&&e._UZ(0,"mat-spinner")}function Vr(t,n){if(1&t&&(e.TgZ(0,"div",75),e.YNc(1,$r,1,0,"mat-spinner",4),e.qZA()),2&t){const r=e.oxw();e.xp6(1),e.Q6J("ngIf",r.isLoading)}}let re=(()=>{class t extends y.H{constructor(r,a,o,s,l,d,x,J,w,zr,Xr,Kr,Wr,en){super(d),this.fb=r,this.supplierService=a,this.toastrService=o,this.purchaseOrderService=s,this.router=l,this.translationService=d,this.commonService=x,this.taxService=J,this.productService=w,this.route=zr,this.quantitiesUnitPricePipe=Xr,this.quantitiesUnitPriceTaxPipe=Kr,this.location=Wr,this.cloneService=en,this.products=[],this.suppliers=[],this.suppliersForSearch=[],this.purchaseorders=[],this.isLoading=!1,this.isSupplierLoading=!1,this.filterProductsMap={},this.warehouseMap={},this.unitsMap={},this.taxsMap={},this.totalBeforeDiscount=0,this.totalAfterDiscount=0,this.totalDiscount=0,this.grandTotal=0,this.totalTax=0,this.isEdit=!1,this.purchaseOrderRequestList=[],this.getLangDir(),this.supplierResource=new rr.H,this.purchaseResouce=new U.D,this.productResource=new tr.f,this.purchaseOrderResource=new U.D,this.purchaseOrderResource.pageSize=50,this.purchaseOrderResource.orderBy="poCreatedDate asc",this.purchaseOrderResource.isPurchaseOrderRequest=!0}get purchaseOrderItemsArray(){return this.purchaseOrderForm.get("purchaseOrderItems")}ngOnInit(){this.createPurchaseOrder(),this.getTaxes()}onFilterValue(r){console.log(r)}getTaxes(){this.taxes$=this.taxService.entities$}createPurchaseOrderReturnOrder(){this.purchaseOrderReturnForm=this.fb.group({orderNumber:[""],filerSupplier:[""],supplierId:[""],purchaseOrderId:[""],filerPurchaseOrder:[""]}),this.getSuppliers(),this.supplierNameForSearchChangeValue(),this.subscribeSupplierChangeEvent(),this.subscribePurchaseOrderFilterChangeEvent(),this.onPurchaseOrderChange()}subscribeSupplierChangeEvent(){this.purchaseOrderReturnForm.get("supplierId").valueChanges.pipe((0,_.b)(500),(0,g.x)(),(0,f.w)(r=>(this.purchaseResouce.supplierId=r,this.purchaseResouce.status=T.G.Not_Return,this.purchaseOrderService.getAllPurchaseOrder(this.purchaseResouce)))).subscribe(r=>{r&&r.headers&&(this.purchaseorders=[...r.body])})}subscribePurchaseOrderFilterChangeEvent(){this.purchaseOrderReturnForm.get("filerPurchaseOrder").valueChanges.pipe((0,_.b)(500),(0,g.x)(),(0,f.w)(r=>(this.purchaseResouce.orderNumber=r,this.purchaseOrderService.getAllPurchaseOrder(this.purchaseResouce)))).subscribe(r=>{r&&r.headers&&(this.purchaseorders=[...r.body])})}clearFormArray(){for(;0!==this.purchaseOrderItemsArray.length;)this.purchaseOrderItemsArray.removeAt(0)}onPurchaseOrderChange(){this.purchaseOrderReturnForm.get("purchaseOrderId").valueChanges.subscribe(r=>{r&&this.router.navigate(["/purchase-order-return",r])})}createPurchaseOrder(){this.route.data.pipe().subscribe(r=>{this.purchaseOrder=r.purchaseorder,this.purchaseOrder?(this.isEdit=!0,this.purchaseOrderForm=this.fb.group({orderNumber:[{value:this.purchaseOrder.orderNumber,disabled:!1}],filerSupplier:[{value:"",disabled:!0}],deliveryDate:[{value:this.purchaseOrder.deliveryDate,disabled:!0},[u.kI.required]],poCreatedDate:[{value:this.purchaseOrder.poCreatedDate,disabled:!0},[u.kI.required]],deliveryStatus:[this.purchaseOrder.deliveryStatus],supplierId:[{value:this.purchaseOrder.supplierId,disabled:!0},[u.kI.required]],note:[{value:"",disabled:!1}],purchaseOrderItems:this.fb.array([])}),this.purchaseOrder.purchaseOrderItems.forEach(a=>{this.purchaseOrderItemsArray.push(this.createPurchaseOrderItemPatch(this.purchaseOrderItemsArray.length,a))}),this.supplierNameChangeValue(),this.getSuppliers(),this.getAllTotal()):(this.createPurchaseOrderReturnOrder(),this.purchaseResouce.pageSize=10,this.purchaseResouce.status=T.G.Not_Return,this.purchaseOrderService.getAllPurchaseOrder(this.purchaseResouce).subscribe(a=>{a&&a.headers&&(this.purchaseorders=[...a.body])}))})}onAddAnotherProduct(){this.purchaseOrderItemsArray.push(this.createPurchaseOrderItem(this.purchaseOrderItemsArray.length))}createPurchaseOrderItemPatch(r,a){const o=a.purchaseOrderItemTaxes.map(l=>l.taxId),s=this.fb.group({productId:[{value:a.productId,disabled:!0},[u.kI.required]],filterProductValue:[{value:"",disabled:!0}],unitPrice:[{value:a.unitPrice,disabled:!0},[u.kI.required]],quantity:[{value:a.quantity,disabled:!0},[u.kI.required]],reurnquntity:[{value:a.quantity,disabled:!1},[u.kI.required,u.kI.max(a.quantity),u.kI.min(1)]],taxValue:[{value:o,disabled:!0}],unitId:[{value:a.unitId,disabled:!0},[u.kI.required]],warehouseId:[{value:a.warehouseId,disabled:!0}],discountPercentage:[{value:a.discountPercentage,disabled:!0}]});return this.unitsMap[r]=[...this.route.snapshot.data.units],this.taxsMap[r]=[...this.route.snapshot.data.taxs],this.warehouseMap[r]=[...this.route.snapshot.data.warehouses],this.filterProductsMap[r.toString()]=[a.product],this.getProductByNameValue(s,r),s}createPurchaseOrderItem(r){const a=this.fb.group({productId:["",[u.kI.required]],filterProductValue:[""],unitPrice:[0,[u.kI.required]],quantity:[0,[u.kI.required]],taxValue:[null],unitId:[{value:null,disabled:!0}],warehouseId:[{value:null,disabled:!0}],discountPercentage:[0]});return this.unitsMap[r]=[...this.route.snapshot.data.units],this.warehouseMap[r]=[...this.route.snapshot.data.warehouses],this.taxsMap[r]=[...this.route.snapshot.data.taxs],this.filterProductsMap[r.toString()]=[...this.route.snapshot.data.products],this.getProductByNameValue(a,r),a}getProductByNameValue(r,a){this.purchaseOrder&&this.getProducts(a),this.sub$.sink=r.get("filterProductValue").valueChanges.pipe((0,_.b)(500),(0,g.x)(),(0,f.w)(o=>(this.productResource.name=o,this.productService.getProducts(this.productResource)))).subscribe(o=>{o&&o.headers&&(this.filterProductsMap[a.toString()]=[...o.body])},o=>{})}getAllTotal(){let a=this.purchaseOrderForm.get("purchaseOrderItems").getRawValue();this.totalBeforeDiscount=0,this.grandTotal=0,this.totalDiscount=0,this.totalTax=0,a&&a.length>0&&a.forEach(o=>{if(o.unitPrice&&o.reurnquntity){const s=this.totalBeforeDiscount+parseFloat(this.quantitiesUnitPricePipe.transform(o.reurnquntity,o.unitPrice));this.totalBeforeDiscount=parseFloat(s.toFixed(2));const l=this.grandTotal+parseFloat(this.quantitiesUnitPricePipe.transform(o.reurnquntity,o.unitPrice,o.discountPercentage,o.taxValue,this.taxsMap[0]));this.grandTotal=parseFloat(l.toFixed(2));const d=this.totalTax+parseFloat(this.quantitiesUnitPriceTaxPipe.transform(o.reurnquntity,o.unitPrice,o.discountPercentage,o.taxValue,this.taxsMap[0]));this.totalTax=parseFloat(d.toFixed(2));const x=this.totalDiscount+parseFloat(this.quantitiesUnitPriceTaxPipe.transform(o.reurnquntity,o.unitPrice,o.discountPercentage));this.totalDiscount=parseFloat(x.toFixed(2))}})}onUnitPriceChange(){this.getAllTotal()}onQuantityChange(){this.getAllTotal()}onDiscountChange(){this.getAllTotal()}onTaxSelectionChange(){this.getAllTotal()}onRemovePurchaseOrderItem(r){this.purchaseOrderItemsArray.removeAt(r),this.purchaseOrderItemsArray.controls.forEach((a,o)=>{const s=a.get("productId").value;this.purchaseOrder.purchaseOrderItems.map(l=>{l.product.id===s&&(this.filterProductsMap[o.toString()]=this.cloneService.deepClone([l.product]))})}),this.getAllTotal()}getProducts(r){0===this.products.length?(this.productResource.name="",this.productService.getProducts(this.productResource).subscribe(a=>{this.products=[...a.body],this.filterProductsMap[r.toString()]=[...a.body]},a=>{})):this.filterProductsMap[r.toString()]=[...this.products]}onProductSelectionChange(r,a){const o=this.filterProductsMap[a].find(s=>s.id===r.value);this.purchaseOrderItemsArray.controls[a].patchValue({filterProductValue:""}),this.purchaseOrderItemsArray.controls[a].patchValue({unitId:o.unitId}),o.productTaxes.length&&this.purchaseOrderItemsArray.controls[a].patchValue({taxValue:o.productTaxes.map(s=>s.taxId),warehouseId:o.warehouseId})}supplierNameForSearchChangeValue(){this.sub$.sink=this.purchaseOrderReturnForm.get("filerSupplier").valueChanges.pipe((0,L.b)(r=>this.isSupplierLoading=!0),(0,_.b)(500),(0,g.x)(),(0,f.w)(r=>(this.supplierResource.supplierName=r,this.supplierResource.id=null,this.supplierService.getSuppliers(this.supplierResource)))).subscribe(r=>{this.isSupplierLoading=!1,r&&r.headers&&(this.suppliersForSearch=[...r.body])},r=>{this.isSupplierLoading=!1})}supplierNameChangeValue(){this.sub$.sink=this.purchaseOrderForm.get("filerSupplier").valueChanges.pipe((0,L.b)(r=>this.isSupplierLoading=!0),(0,_.b)(500),(0,g.x)(),(0,f.w)(r=>(this.supplierResource.supplierName=r,this.supplierResource.id=null,this.supplierService.getSuppliers(this.supplierResource)))).subscribe(r=>{this.isSupplierLoading=!1,r&&r.headers&&(this.suppliers=[...r.body])},r=>{this.isSupplierLoading=!1})}getSuppliers(){this.purchaseOrder?this.supplierResource.id=this.purchaseOrder.supplierId:(this.supplierResource.supplierName="",this.supplierResource.id=null),this.supplierService.getSuppliers(this.supplierResource).subscribe(r=>{r&&r.headers&&(this.suppliers=[...r.body],this.suppliersForSearch=[...r.body])})}onPurchaseOrderSubmit(){if(this.purchaseOrderForm.valid){if(this.purchaseOrder&&this.purchaseOrder.purchaseOrderStatus===T.G.Return)return void this.toastrService.error(this.translationService.getValue("RETURN_PURCHASE_ORDER_CANT_BE_EDITED"));this.isLoading=!0;const r=this.buildPurchaseOrder();r.id&&this.purchaseOrderService.updatePurchaseOrderReturn(r).subscribe(a=>{this.isLoading=!1,this.toastrService.success(this.translationService.getValue("PURCHASE_ORDER_RETURN_ADDED")),this.router.navigate(["/purchase-order/list"])},a=>{this.isLoading=!1})}else this.purchaseOrderForm.markAllAsTouched()}buildPurchaseOrder(){const r={id:this.purchaseOrder?this.purchaseOrder.id:"",orderNumber:this.purchaseOrderForm.get("orderNumber").value,deliveryDate:this.purchaseOrderForm.get("deliveryDate").value,deliveryStatus:er.I.UnDelivery,isPurchaseOrderRequest:!1,poCreatedDate:this.purchaseOrderForm.get("poCreatedDate").value,purchaseOrderStatus:T.G.Return,supplierId:this.purchaseOrderForm.get("supplierId").value,totalAmount:this.grandTotal,totalDiscount:this.totalDiscount,totalTax:this.totalTax,note:this.purchaseOrderForm.get("note").value,purchaseOrderItems:[]},o=this.purchaseOrderForm.get("purchaseOrderItems").getRawValue();return o&&o.length>0&&o.forEach(s=>{r.purchaseOrderItems.push({discount:parseFloat(this.quantitiesUnitPriceTaxPipe.transform(s.reurnquntity,s.unitPrice,s.discountPercentage)),discountPercentage:s.discountPercentage,productId:s.productId,unitId:s.unitId,warehouseId:s.warehouseId,quantity:s.reurnquntity,taxValue:parseFloat(this.quantitiesUnitPriceTaxPipe.transform(s.reurnquntity,s.unitPrice,s.discountPercentage,s.taxValue,this.taxsMap[0])),unitPrice:parseFloat(s.unitPrice),purchaseOrderItemTaxes:s.taxValue?[...s.taxValue.map(l=>({taxId:l}))]:[]})}),r}cancel(){this.location.back()}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(u.QS),e.Y36(z.p),e.Y36(X._W),e.Y36(b.x),e.Y36(h.F0),e.Y36(S.D),e.Y36(nr.v),e.Y36(ar.D),e.Y36(or.M),e.Y36(h.gz),e.Y36(F.q),e.Y36(Q.S),e.Y36(p.Ye),e.Y36(K.$))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-purchase-order-return"]],features:[e._Bn([],[F.q,Q.S]),e.qOj],decls:10,vars:6,consts:[[1,"page-header-main"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],[4,"ngIf"],["class","loading-shade",4,"ngIf"],["autocomplete","off",3,"formGroup"],[1,"row"],[1,"col-sm-6","col-md-4"],[1,"form-group"],[1,"input-group"],["formControlName","supplierId",1,"form-control",3,"dir","placeholder"],["formControlName","filerSupplier","focused","'true'","type","text","autocomplete","off",1,"form-control","w-100",3,"placeholder"],[3,"dir","value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value",4,"ngIf"],["formControlName","purchaseOrderId",1,"form-control",3,"dir","placeholder"],["formControlName","filerPurchaseOrder","focused","'true'","type","text","autocomplete","off",1,"form-control","w-100",3,"placeholder"],[3,"dir","value"],["value",""],[3,"value"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"col-sm-4"],[1,"text-danger"],["formControlName","orderNumber","type","text",1,"form-control","w-100",3,"readonly"],[1,"col-md-4"],["for","poCreatedDate",1,"text-danger"],["id","poCreatedDate","formControlName","poCreatedDate",1,"form-control",3,"owlDateTimeTrigger","owlDateTime","placeholder"],[3,"pickerType"],["poCreatedDate",""],["for","deliveryDate",1,"text-danger"],["id","deliveryDate","formControlName","deliveryDate",1,"form-control",3,"owlDateTimeTrigger","owlDateTime","placeholder"],["deliveryDate",""],["formControlName","supplierId","placeholder","Select Supplier",1,"form-control",3,"dir"],["formControlName","filerSupplier","focused","'true'","type","text","autocomplete","off","placeholder","Search other suppliers",1,"form-control","w-100"],[1,"col-sm-12"],["formControlName","note",1,"form-control","w-100"],["formArrayName","purchaseOrderItems",1,"col-sm-12"],[1,"col"],[1,"table-responsive"],[1,"table","table-bordered","table-hover","table-sm"],[1,"table-column-50"],[1,"table-column-200"],[1,"table-column-150"],[1,"table-column-130"],[1,"table-column-120"],[1,"table-column-100"],[1,"table-column-300"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"row","mt-2"],[1,"col-10","text-right","font-weight-bold"],[1,"col-2","text-left","font-weight-bold"],[1,"col-2","text-left","text-danger","font-weight-bold"],[1,"col-12"],[1,"col-md-12","mb-1"],["type","submit","class","btn btn-success btn-sm m-right-10",4,"hasClaim"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"fas","fa-times-circle"],["class","text-danger",4,"ngIf"],[3,"formGroupName"],["mat-icon-button","","aria-label","Action",3,"click",4,"ngIf"],["formControlName","productId","placeholder","Select Product",1,"form-control",3,"dir","selectionChange"],["formControlName","filterProductValue","focused","'true'","type","text","autocomplete","off","placeholder","search other products",1,"form-control","w-100"],["formControlName","warehouseId",1,"form-control-plaintext",3,"dir"],[3,"value",4,"ngFor","ngForOf"],["formControlName","unitId",1,"form-control-plaintext",3,"dir"],["type","number","formControlName","unitPrice",1,"form-control",3,"placeholder"],["type","number","formControlName","quantity",1,"form-control",3,"placeholder"],["type","number","formControlName","reurnquntity",1,"form-control",3,"placeholder","change"],["formControlName","discountPercentage",1,"form-control",3,"placeholder","change"],["formControlName","taxValue","placeholder","Tax","multiple","",1,"form-control",3,"selectionChange"],["mat-icon-button","","aria-label","Action",3,"click"],[1,"btn-danger"],["type","submit",1,"btn","btn-success","btn-sm","m-right-10"],[1,"fas","fa-save"],[1,"loading-shade"]],template:function(r,a){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),e._uU(5),e.ALo(6,"translate"),e.qZA()()()()(),e.YNc(7,pr,30,26,"ng-container",4),e.YNc(8,Br,135,98,"ng-container",4),e.YNc(9,Vr,2,1,"div",5)),2&r&&(e.xp6(5),e.Oqu(e.lcZ(6,4,"PURCHASE_ORDER_RETURN")),e.xp6(2),e.Q6J("ngIf",!a.purchaseOrder),e.xp6(1),e.Q6J("ngIf",a.purchaseOrder),e.xp6(1),e.Q6J("ngIf",a.isLoading))},dependencies:[p.sg,p.O5,u._Y,u.Fj,u.wV,u.JJ,u.JL,u.sg,u.u,u.x0,u.CE,W.d,E.Lv,M.gD,C.ey,R.Hw,P.lW,A.Ou,O.sZ,O.BO,O.hV,B.d,q.R,Y.X$,F.q,Q.S],styles:[".hr[_ngcontent-%COMP%]{border-bottom:1px solid #2095F3}"]}),t})();const Hr=[{path:"list",component:Wt,data:{claimType:"PO_RETURN_PO"},canActivate:[I.a]},{path:"add",component:re,data:{claimType:"PO_RETURN_PO"},canActivate:[I.a],resolve:{units:k.O,warehouses:G.k,taxs:H._,products:V.S}},{path:":id",component:re,data:{claimType:"PO_RETURN_PO"},canActivate:[I.a],resolve:{units:k.O,taxs:H._,warehouses:G.k,purchaseorder:le.Z,products:V.S}}];let kr=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.Bz.forChild(Hr),h.Bz]}),t})(),Gr=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[p.ez,u.u5,u.UX,ne.m,ae.FA,C.XK,oe.c,ie.lN,se.Fk,M.LD,ue.QW,Z.Tx,R.Ps,P.ot,N.Bb,A.Cq,O.Ll,O.x,ce.p9,B.t,$.Is,kr,c.p0,D.TU,v.JX]}),t})()}}]);